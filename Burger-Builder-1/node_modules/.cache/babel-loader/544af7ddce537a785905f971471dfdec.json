{"ast":null,"code":"var _jsxFileName = \"/home/gunjan/Desktop/bb-project/src/containers/BurgerBuilder/BurgerBuilder.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport Aux from '../../hoc/Aux/Aux';\nimport Burger from '../../components/Burger/Burger';\nimport BurgerControls from '../../components/Burger/BuildControls/BuildControls';\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary';\nimport Modal from '../../components/UI/Modal/Modal';\nimport axios from '../../axios-orders';\nimport Spinner from '../../components/UI/Spinner/Spinner';\nimport withErrorHandler from '../../hoc/withErrorHandler/withErrorHandler';\nimport * as actions from '../../store/actions/index';\n\nclass BurgerBuilder extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      //purchasable is used to unlock/enabled or disabled the ORDER button.\n      // purchasable:false,\n      //to show or hide the modal\n      purchasing: false //when loading is true i want to show the spinner and on false orderSummary.\n      // loading:false,\n      // error:false\n\n    };\n\n    this.updatePurchaseState = ingredients => {\n      const sum = Object.keys(ingredients).map(igKey => {\n        return ingredients[igKey];\n      }).reduce((sum, elt) => {\n        return sum + elt;\n      }, 0);\n      return sum > 0;\n    };\n\n    this.purchaseHandler = () => {\n      if (this.props.isAuthenticated) {\n        this.setState({\n          purchasing: true\n        });\n      } else {\n        this.props.history.push('/auth');\n      }\n    };\n\n    this.purchaseCancelHandler = () => {\n      this.setState({\n        purchasing: false\n      });\n    };\n\n    this.purchaseContinueHandler = () => {\n      // // alert('You can Continue...!')\n      this.props.onInitPurchase();\n      this.props.history.push('/checkout');\n      /*const queryParams = [];\n          for (let i in this.state.ingredients) {\n              queryParams.push(encodeURIComponent(i) + '=' + encodeURIComponent(this.state.ingredients[i]));\n          }\n           queryParams.push('price=' + this.state.totalPrice);\n           const queryString = queryParams.join('&');\n          \n           this.props.history.push({\n              pathname: '/checkout',\n              search: '?' + queryString\n          });\n          */\n    };\n  }\n\n  //i can execute this axios.get call here in redux(setState na use kr ke hum action dispatch kar skte hai which updates our ingredients in the redux store)\n  //or the better way of doing is using action-creators by redux-thunk.\n  componentDidMount() {\n    console.log(this.props);\n    this.props.onInitIngredients(); // axios.get('https://burger-builder-ea9c2.firebaseio.com/ingredients.json')\n    // .then( response => {\n    //     this.setState({ingredients: response.data});\n    // })\n    // .catch(error =>{\n    //     this.setState({error:true})\n    // });\n  } //I want array of values from ingredients objects and need to reduce it to a single value(Sum)\n  //sum is constantly updated in reduce function by each element(value) of the the array\n  //if sum>0 then set purchasable to true or else false.\n  //now it returns either true or false.\n\n\n  render() {\n    //tell which button should be enabled or disabled. \n    const disabledInfo = { ...this.props.ings\n    };\n\n    for (let key in disabledInfo) {\n      disabledInfo[key] = disabledInfo[key] <= 0;\n    } //{salad:true,meat:false,...} and if its true then it is disabled.\n\n\n    let orderSummary = null; //will render spinner for a fraction of second when we load app for the first time..\n\n    let burger = this.props.error ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 41\n      }\n    }, \"Ingredients can't be loaded!\") : /*#__PURE__*/React.createElement(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 79\n      }\n    });\n\n    if (this.props.ings) {\n      burger = /*#__PURE__*/React.createElement(Aux, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Burger, {\n        ingredients: this.props.ings,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(BurgerControls, {\n        ingredientsAdd: this.props.onIngredientsAdded,\n        ingredientsRemove: this.props.onIngredientsRemoved,\n        disabled: disabledInfo,\n        purchasable: this.updatePurchaseState(this.props.ings),\n        displayOrder: this.purchaseHandler,\n        isAuth: this.props.isAuthenticated,\n        price: this.props.price,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }\n      }));\n      orderSummary = /*#__PURE__*/React.createElement(OrderSummary, {\n        ingredients: this.props.ings,\n        orderCancelled: this.purchaseCancelHandler,\n        orderContinue: this.purchaseContinueHandler,\n        price: this.props.price,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 26\n        }\n      });\n    } //if true then show spinner..\n    // if(this.state.loading){\n    //     orderSummary=<Spinner />\n    // }\n\n\n    return /*#__PURE__*/React.createElement(Aux, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Modal, {\n      show: this.state.purchasing,\n      modalClosed: this.purchaseCancelHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }\n    }, orderSummary), burger);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    ings: state.burgerBuilder.ingredients,\n    price: state.burgerBuilder.totalPrice,\n    error: state.burgerBuilder.error,\n    isAuthenticated: state.auth.token !== null\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onIngredientsAdded: ingName => dispatch(actions.addIngredient(ingName)),\n    onIngredientsRemoved: ingName => dispatch(actions.removeIngredient(ingName)),\n    onInitIngredients: () => dispatch(actions.initIngredients()),\n    onInitPurchase: () => dispatch(actions.purchaseInit())\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withErrorHandler(BurgerBuilder, axios));","map":{"version":3,"sources":["/home/gunjan/Desktop/bb-project/src/containers/BurgerBuilder/BurgerBuilder.js"],"names":["React","Component","connect","Aux","Burger","BurgerControls","OrderSummary","Modal","axios","Spinner","withErrorHandler","actions","BurgerBuilder","state","purchasing","updatePurchaseState","ingredients","sum","Object","keys","map","igKey","reduce","elt","purchaseHandler","props","isAuthenticated","setState","history","push","purchaseCancelHandler","purchaseContinueHandler","onInitPurchase","componentDidMount","console","log","onInitIngredients","render","disabledInfo","ings","key","orderSummary","burger","error","onIngredientsAdded","onIngredientsRemoved","price","mapStateToProps","burgerBuilder","totalPrice","auth","token","mapDispatchToProps","dispatch","ingName","addIngredient","removeIngredient","initIngredients","purchaseInit"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport Aux from '../../hoc/Aux/Aux';\nimport Burger from '../../components/Burger/Burger';\nimport BurgerControls from '../../components/Burger/BuildControls/BuildControls';\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary';\nimport Modal from '../../components/UI/Modal/Modal';\nimport axios from '../../axios-orders';\nimport Spinner from '../../components/UI/Spinner/Spinner';\nimport withErrorHandler from '../../hoc/withErrorHandler/withErrorHandler';\nimport * as actions from '../../store/actions/index';\n\n\nclass BurgerBuilder extends Component{\n    state={\n        //purchasable is used to unlock/enabled or disabled the ORDER button.\n        // purchasable:false,\n        //to show or hide the modal\n        purchasing:false,\n        //when loading is true i want to show the spinner and on false orderSummary.\n        // loading:false,\n        // error:false\n       \n    }\n\n    //i can execute this axios.get call here in redux(setState na use kr ke hum action dispatch kar skte hai which updates our ingredients in the redux store)\n    //or the better way of doing is using action-creators by redux-thunk.\n    componentDidMount(){\n        console.log(this.props);\n        this.props.onInitIngredients();\n        // axios.get('https://burger-builder-ea9c2.firebaseio.com/ingredients.json')\n        // .then( response => {\n        //     this.setState({ingredients: response.data});\n        // })\n        // .catch(error =>{\n        //     this.setState({error:true})\n        // });\n    }\n\n//I want array of values from ingredients objects and need to reduce it to a single value(Sum)\n//sum is constantly updated in reduce function by each element(value) of the the array\n//if sum>0 then set purchasable to true or else false.\n//now it returns either true or false.\nupdatePurchaseState=(ingredients)=>{\n    \n    const sum=Object.keys(ingredients)\n    .map(igKey=>{\n        return ingredients[igKey];\n    })\n    .reduce((sum,elt)=>{\n        return sum+elt;\n    },0);\n    return sum>0;\n\n};\n\n\n\n/* addIngredientsHandler=(type)=>{\n    const oldCount=this.state.ingredients[type];\n    const updatedCount=oldCount+1;\n    const updatedIngredients={\n        ...this.state.ingredients\n    };\n    updatedIngredients[type]=updatedCount;\n    const priceAddition=INGREDIENT_PRICES[type];\n    const oldPrice=this.state.totalPrice;\n    const newPrice=oldPrice+priceAddition;\n    this.setState({totalPrice:newPrice,ingredients:updatedIngredients});\n    this.updatePurchaseState(updatedIngredients);\n\n}\n\nremoveIngredientsHandler=(type)=>{\n    const oldCount=this.state.ingredients[type];\n    if(oldCount<=0){\n        return;\n    }\n    const updatedCount=oldCount-1;\n    const updatedIngredients={\n        ...this.state.ingredients\n    };\n    updatedIngredients[type]=updatedCount;\n    const priceDeduction=INGREDIENT_PRICES[type];\n    const oldPrice=this.state.totalPrice;\n    const newPrice=oldPrice-priceDeduction;\n    this.setState({totalPrice:newPrice,ingredients:updatedIngredients});\n    this.updatePurchaseState(updatedIngredients);\n\n}\n*/\n\npurchaseHandler=()=>{\n    if(this.props.isAuthenticated){\n        this.setState({purchasing:true})\n    }else{\n        this.props.history.push('/auth');\n    }\n   \n}\n\npurchaseCancelHandler=()=>{\n    this.setState({purchasing:false})\n}\n\npurchaseContinueHandler=()=>{\n    // // alert('You can Continue...!')\n    this.props.onInitPurchase();\n    this.props.history.push('/checkout');\n\n    /*const queryParams = [];\n        for (let i in this.state.ingredients) {\n            queryParams.push(encodeURIComponent(i) + '=' + encodeURIComponent(this.state.ingredients[i]));\n        }\n\n        queryParams.push('price=' + this.state.totalPrice);\n\n        const queryString = queryParams.join('&');\n        \n\n        this.props.history.push({\n            pathname: '/checkout',\n            search: '?' + queryString\n        });\n        */\n}\n\n    render(){\n        //tell which button should be enabled or disabled. \n        const disabledInfo={\n            ...this.props.ings\n        };\n        for(let key in disabledInfo){\n            disabledInfo[key]=disabledInfo[key]<=0\n        }\n        //{salad:true,meat:false,...} and if its true then it is disabled.\n\n        let orderSummary=null;\n        //will render spinner for a fraction of second when we load app for the first time..\n        let burger = this.props.error ? <p>Ingredients can't be loaded!</p> : <Spinner />;\n\n        if(this.props.ings){\n            burger=(\n                <Aux>\n                    <Burger ingredients={this.props.ings}/>\n                    <BurgerControls \n                        ingredientsAdd={this.props.onIngredientsAdded} \n                        ingredientsRemove={this.props.onIngredientsRemoved}\n                        disabled={disabledInfo}\n                        purchasable={this.updatePurchaseState(this.props.ings)}\n                        displayOrder={this.purchaseHandler}\n                        isAuth={this.props.isAuthenticated}\n                        price={this.props.price}/>\n                </Aux>\n            );\n            orderSummary=<OrderSummary \n            ingredients={this.props.ings}\n            orderCancelled={this.purchaseCancelHandler}\n            orderContinue={this.purchaseContinueHandler}\n            price={this.props.price}/>;\n        }\n\n        //if true then show spinner..\n        // if(this.state.loading){\n        //     orderSummary=<Spinner />\n        // }\n\n        return(\n            <Aux>\n                {/*OrderSummary is re0rendending again agian bcz it uses setState (states that are changed),so to avoid this\n                if the model is you want to display then only order summary should be re-renderrd else not */}\n                <Modal show={this.state.purchasing} modalClosed={this.purchaseCancelHandler}>\n                    {orderSummary}\n                </Modal>\n                {burger}\n                \n            </Aux>    \n        );\n    }\n}\n\n\nconst mapStateToProps = state => {\n    return {\n        ings:state.burgerBuilder.ingredients,\n        price:state.burgerBuilder.totalPrice,\n        error:state.burgerBuilder.error,\n        isAuthenticated:state.auth.token !== null\n    };\n}\n\n const mapDispatchToProps = dispatch => {\n    return{\n        onIngredientsAdded : (ingName) => dispatch(actions.addIngredient(ingName)),\n        onIngredientsRemoved : (ingName) => dispatch(actions.removeIngredient(ingName)),\n        onInitIngredients : () => dispatch(actions.initIngredients()),\n        onInitPurchase: () => dispatch(actions.purchaseInit())\n    }\n\n }\n\nexport default connect(mapStateToProps,mapDispatchToProps)(withErrorHandler(BurgerBuilder,axios));\n\n\n"]},"metadata":{},"sourceType":"module"}