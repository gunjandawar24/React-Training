{"ast":null,"code":"var _jsxFileName = \"/home/gunjan/Desktop/React-hooks/bb-project(using hooks)/src/containers/BurgerBuilder/BurgerBuilder.js\";\nimport React, { useState, useEffect } from 'react';\nimport { connect, useDispatch, useSelector } from 'react-redux';\nimport Aux from '../../hoc/Aux/Aux';\nimport Burger from '../../components/Burger/Burger';\nimport BurgerControls from '../../components/Burger/BuildControls/BuildControls';\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary';\nimport Modal from '../../components/UI/Modal/Modal';\nimport axios from '../../axios-orders';\nimport Spinner from '../../components/UI/Spinner/Spinner';\nimport withErrorHandler from '../../hoc/withErrorHandler/withErrorHandler';\nimport * as actions from '../../store/actions/index';\nexport const BurgerBuilder = props => {\n  const [purchasing, setPurchasing] = useState(false); //dispatches an action to a redux store.\n\n  const dispatch = useDispatch();\n\n  const onIngredientsAdded = ingName => dispatch(actions.addIngredient(ingName));\n\n  const onIngredientsRemoved = ingName => dispatch(actions.removeIngredient(ingName));\n\n  const onInitIngredients = () => dispatch(actions.initIngredients());\n\n  const onInitPurchase = () => dispatch(actions.purchaseInit());\n\n  const onSetAuthRedirectPath = path => dispatch(actions.setAuthRedirectPath(path));\n\n  useEffect(() => {\n    onInitIngredients();\n  }, [onInitIngredients]); //I want array of values from ingredients objects and need to reduce it to a single value(Sum)\n  //sum is constantly updated in reduce function by each element(value) of the the array\n  //if sum>0 then set purchasable to true or else false.\n  //now it returns either true or false.\n\n  const updatePurchaseState = ingredients => {\n    const sum = Object.keys(ingredients).map(igKey => {\n      return ingredients[igKey];\n    }).reduce((sum, elt) => {\n      return sum + elt;\n    }, 0);\n    return sum > 0;\n  };\n\n  const purchaseHandler = () => {\n    if (props.isAuthenticated) {\n      setPurchasing(true);\n    } else {\n      onSetAuthRedirectPath('/checkout');\n      props.history.push('/auth');\n    }\n  };\n\n  const purchaseCancelHandler = () => {\n    setPurchasing(false);\n  };\n\n  const purchaseContinueHandler = () => {\n    // // alert('You can Continue...!')\n    onInitPurchase();\n    props.history.push('/checkout');\n  }; //tell which button should be enabled or disabled. \n\n\n  const disabledInfo = { ...props.ings\n  };\n\n  for (let key in disabledInfo) {\n    disabledInfo[key] = disabledInfo[key] <= 0;\n  } //{salad:true,meat:false,...} and if its true then it is disabled.\n\n\n  let orderSummary = null; //will render spinner for a fraction of second when we load app for the first time..\n\n  let burger = props.error ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 36\n    }\n  }, \"Ingredients can't be loaded!\") : /*#__PURE__*/React.createElement(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 74\n    }\n  });\n\n  if (props.ings) {\n    burger = /*#__PURE__*/React.createElement(Aux, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Burger, {\n      ingredients: props.ings,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(BurgerControls, {\n      ingredientsAdd: onIngredientsAdded,\n      ingredientsRemove: onIngredientsRemoved,\n      disabled: disabledInfo,\n      purchasable: updatePurchaseState(props.ings),\n      displayOrder: purchaseHandler,\n      isAuth: props.isAuthenticated,\n      price: props.price,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 21\n      }\n    }));\n    orderSummary = /*#__PURE__*/React.createElement(OrderSummary, {\n      ingredients: props.ings,\n      orderCancelled: purchaseCancelHandler,\n      orderContinue: purchaseContinueHandler,\n      price: props.price,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 26\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(Aux, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    show: purchasing,\n    modalClosed: purchaseCancelHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, orderSummary), burger);\n};\n\nconst mapStateToProps = state => {\n  return {\n    ings: state.burgerBuilder.ingredients,\n    price: state.burgerBuilder.totalPrice,\n    error: state.burgerBuilder.error,\n    isAuthenticated: state.auth.token !== null\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onIngredientsAdded: ingName => dispatch(actions.addIngredient(ingName)),\n    onIngredientsRemoved: ingName => dispatch(actions.removeIngredient(ingName)),\n    onInitIngredients: () => dispatch(actions.initIngredients()),\n    onInitPurchase: () => dispatch(actions.purchaseInit()),\n    onSetAuthRedirectPath: path => dispatch(actions.setAuthRedirectPath(path))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withErrorHandler(BurgerBuilder, axios));","map":{"version":3,"sources":["/home/gunjan/Desktop/React-hooks/bb-project(using hooks)/src/containers/BurgerBuilder/BurgerBuilder.js"],"names":["React","useState","useEffect","connect","useDispatch","useSelector","Aux","Burger","BurgerControls","OrderSummary","Modal","axios","Spinner","withErrorHandler","actions","BurgerBuilder","props","purchasing","setPurchasing","dispatch","onIngredientsAdded","ingName","addIngredient","onIngredientsRemoved","removeIngredient","onInitIngredients","initIngredients","onInitPurchase","purchaseInit","onSetAuthRedirectPath","path","setAuthRedirectPath","updatePurchaseState","ingredients","sum","Object","keys","map","igKey","reduce","elt","purchaseHandler","isAuthenticated","history","push","purchaseCancelHandler","purchaseContinueHandler","disabledInfo","ings","key","orderSummary","burger","error","price","mapStateToProps","state","burgerBuilder","totalPrice","auth","token","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { connect , useDispatch , useSelector } from 'react-redux';\nimport Aux from '../../hoc/Aux/Aux';\nimport Burger from '../../components/Burger/Burger';\nimport BurgerControls from '../../components/Burger/BuildControls/BuildControls';\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary';\nimport Modal from '../../components/UI/Modal/Modal';\nimport axios from '../../axios-orders';\nimport Spinner from '../../components/UI/Spinner/Spinner';\nimport withErrorHandler from '../../hoc/withErrorHandler/withErrorHandler';\nimport * as actions from '../../store/actions/index';\n\n\nexport const BurgerBuilder = props => {\n    const [purchasing,setPurchasing] = useState(false);\n\n    //dispatches an action to a redux store.\n    const dispatch = useDispatch();\n\n    const onIngredientsAdded = (ingName) => dispatch(actions.addIngredient(ingName));\n    const onIngredientsRemoved = (ingName) => dispatch(actions.removeIngredient(ingName));\n    const onInitIngredients = () => dispatch(actions.initIngredients());\n    const onInitPurchase= () => dispatch(actions.purchaseInit());\n    const onSetAuthRedirectPath = (path) => dispatch(actions.setAuthRedirectPath(path));\n\n    useEffect(() => {\n        onInitIngredients();\n    },[onInitIngredients]);\n\n//I want array of values from ingredients objects and need to reduce it to a single value(Sum)\n//sum is constantly updated in reduce function by each element(value) of the the array\n//if sum>0 then set purchasable to true or else false.\n//now it returns either true or false.\nconst updatePurchaseState=(ingredients)=>{\n    \n    const sum=Object.keys(ingredients)\n    .map(igKey=>{\n        return ingredients[igKey];\n    })\n    .reduce((sum,elt)=>{\n        return sum+elt;\n    },0);\n    return sum>0;\n\n};\n\n\nconst purchaseHandler=()=>{\n    if(props.isAuthenticated){\n        setPurchasing(true);\n    }else{\n        onSetAuthRedirectPath('/checkout');\n        props.history.push('/auth');\n    }\n   \n}\n\nconst purchaseCancelHandler=()=>{\n    setPurchasing(false);\n}\n\nconst purchaseContinueHandler=()=>{\n    // // alert('You can Continue...!')\n    onInitPurchase();\n    props.history.push('/checkout');\n}\n\n        //tell which button should be enabled or disabled. \n        const disabledInfo={\n            ...props.ings\n        };\n        for(let key in disabledInfo){\n            disabledInfo[key]=disabledInfo[key]<=0\n        }\n        //{salad:true,meat:false,...} and if its true then it is disabled.\n\n        let orderSummary=null;\n        //will render spinner for a fraction of second when we load app for the first time..\n        let burger = props.error ? <p>Ingredients can't be loaded!</p> : <Spinner />;\n\n        if(props.ings){\n            burger=(\n                <Aux>\n                    <Burger ingredients={props.ings}/>\n                    <BurgerControls \n                        ingredientsAdd={onIngredientsAdded} \n                        ingredientsRemove={onIngredientsRemoved}\n                        disabled={disabledInfo}\n                        purchasable={updatePurchaseState(props.ings)}\n                        displayOrder={purchaseHandler}\n                        isAuth={props.isAuthenticated}\n                        price={props.price}/>\n                </Aux>\n            );\n            orderSummary=<OrderSummary \n            ingredients={props.ings}\n            orderCancelled={purchaseCancelHandler}\n            orderContinue={purchaseContinueHandler}\n            price={props.price}/>;\n        }\n\n        return(\n            <Aux>\n                {/*OrderSummary is re0rendending again agian bcz it uses setState (states that are changed),so to avoid this\n                if the model is you want to display then only order summary should be re-renderrd else not */}\n                <Modal \n                show={purchasing} \n                modalClosed={purchaseCancelHandler}>\n                    {orderSummary}\n                </Modal>\n                {burger}\n                \n            </Aux>    \n        );\n    }\n\n\nconst mapStateToProps = state => {\n    return {\n        ings:state.burgerBuilder.ingredients,\n        price:state.burgerBuilder.totalPrice,\n        error:state.burgerBuilder.error,\n        isAuthenticated:state.auth.token !== null\n    };\n}\n\n const mapDispatchToProps = dispatch => {\n    return{\n        onIngredientsAdded : (ingName) => dispatch(actions.addIngredient(ingName)),\n        onIngredientsRemoved : (ingName) => dispatch(actions.removeIngredient(ingName)),\n        onInitIngredients : () => dispatch(actions.initIngredients()),\n        onInitPurchase: () => dispatch(actions.purchaseInit()),\n        onSetAuthRedirectPath : (path) => dispatch(actions.setAuthRedirectPath(path))\n    }\n\n }\n\nexport default connect(mapStateToProps,mapDispatchToProps)(withErrorHandler(BurgerBuilder,axios));\n\n\n"]},"metadata":{},"sourceType":"module"}